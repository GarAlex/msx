
    Краткая инструкция по пользовательскому интерфейсу

	    COMMAND.COM version 2.0/2.0M
	       (c) 1986,1987  STS co.

            Версия от 5 марта 1987 года.


1.	Нововведенные команды:

  --	WHO[/W метка|/P[/A] [команда]|/L]
        	Без параметров - выдает метку и считывает функциональные
		клавиши с диска.
	    /W текст
		Установка/выдача метки диска.
		Метка диска автоматически выдается при старте системы.
	    /L
		Запись функ. клавиш на диск. Устанавливаются при
		старте системы.

	    /P[/A][ команда]
		Задает/снимает стартовую команду. При старте COMMAND'а,
		если стартовой команды нет, вызывается AUTOEXEC.BAT. Если
		же команда задана, то она выполняется, а AUTOEXEC.BAT не
		вызывается. При задании ключа /A перед выдачей вывески
		COMMAND устанавливает 80-симв. режим (у Галутина).

  --	SET {команда}
	Команды могут разделяться пробелами и имеют следующий вид:
	    nтекст
		Смена значений функциональных клавиш.
		n-цифра(0-F1,1-F2,...). Контрольные
		символы в тексте задаются в виде ^s,
		где s-большая лат. буква. Может быть только
		последней командой для SET.
	    ?
		Выдача значений функ. клавиш.
	    #fb[g]
		Смена цвета экрана(f-основной,b-фон,g-бордюр).
		f,b и g - лат. буквы A,B,...
	    %crgb
		Смена палитры цвета. c-цвет (A,B,...).
		r,g,b-уровни красного, зеленого и синего
		соответственно (цифры 0-7).
	    a
		Галутин's: установить 80 симв/стр.
	    b
		Галутин's: установить 40 симв/стр.
	    c
		Галутин's: установить цифры без SHIFT.
	    d
		Галутин's: установить цифры со SHIFT.

	    +
		Фиксирует COMMAND в памяти. Использовать рекомендуется
		в проверенных ситуациях, команда может привести к краху
		системы (например, при повторном исполнении). Работает
		правильно только под Галутинским ДОСом.
		ВНИМАНИЕ! TOR при фиксированном COMMANDе не работает:
		не пишет файлы на диск!

	    -
		Расфиксирует COMMAND. Повторно выполнять не рекомендуется.


  --	FREE[ д:]
     	Выдача свободного места на диске.

2.	Изменения в стандартных командах.

  --	REM
	Выкинута.

  --	BASIC
	Перед вызовом basicа из 80-симв. режима устанавливается
	40-симв. Инициализирует функ. клавиши для basicа.

  --	TYPE и DEL теперь имеют вид:
	{TYPE|DEL}[/L][/Q][ файл]
	    /L - выдавать обрабатыаемые файлы.
	    /А - не запрашивать подтверждение на выполнение
		 операции.
	Если спецификация однозначна (т.е. A.MAC, например),
	подтверждение не запрашивается. Если же спецификация может
	выбрать более одного файла с диска, то автоматически вклю-
	чается режим с подтверждением (если не стоит ключа /A).
	На запрос возможны ответы: Y-да, N-нет, G-начиная с этого
	файла для всех остальных выдается ДА автоматом (имена
	печатаются).
	    TYPE теперь печатает все файлы, удовлетворяющие
	многозначным спецификациям, а так же у него появился
	ключ /P, который указывает печать на принтер. TYPE
	сам обрабатывает ctrl-S и ctrl-O. После ctrl-S продолжает
	выдачу по любому символу, кроме ctrl-S, а ctrl-O оканчивает
	выдачу текущего файла.

	Теперь о спецификации <файл>:
	  <файл>::= [ д: ] [ <спец> ] [ ! <спец> ]
	  <спец>::= { { <поле> } [ . { <поле> } ] / , }
	  <поле>::= * | ? | строка | ( { <поле> / , } )
	где скобки [] указывают необязательную часть,
	{a/b} означает сколько угодно повторений a через b
	(например, "ababa"). Если b пусто, то часть /b опущена.
	Вертикальная палка | разделяет альтернативы.
	   Знак "!" в <файл> означает отрицание - все файлы кроме.
	Если опустить <поле> в <спец>, то автоматически ставится "*".
	Например, следующие спецификации эквивалентны:
		.MAC	<=>	*.MAC
		A	<=>	A.*
		пусто	<=>	*.*
	Конструкция (A,B,C) означает A или B или C.
 	Примеры:
		*.com
		a.mac,b.c,c.rel
		(a,b,c).(c,asm,rel,com)
		com*c.com
		*.com!m80.*
		!(m80,l80,cf,cg).*
	При обработке спецификации может возникнуть ошибка
	вида "?COMPLEX". При этом надо упростить спецификацию,
	т.к. система не способна ее обработать.

  --	DIR[/P][/W][ файл]
	Поддерживается спецификация файла, описанная в предыдущем
	пункте. Также не выдает время записи в файл, а в последней
	строке выдает место, занятое всеми выданными файлами (в
	обычной системе - общее своб. место на диске).

  --	COPY[/Q] ...
	В этой команде спецификация файла и ключи стандартные.
	Добавлен ключ /Q - запрос подтверждения на копирование
	файлов. Возможные ответы: Y,N,G (см. пункт про TYPE/DEL).
	Работает только при копировании с диска на диск.

  --	PAUSE
	При использовании (или при выдаче DIR/P) выдает промпт "?>".
	При пустой посылке продолжает работу, при непустой - обрабатывает
	введенный текст как команду (для DIR/P при этом завершает выдачу
	каталога). Заметьте, что теперь внутри .BAT файла можно выполнить
	команду, введенную пользователем по его усмотрению.

  --	DATE[ mm/dd[/yy]]
	При смене даты пишет ее на диск (не в файл, а в спец. сектор).
	Тогда при перезапуске системы с этого диска дата устанавливается
	автоматом, и, следовательно, ее не надо устанавливать каждый раз.
	С пустым параметром - печатает текущую дату.

3.	Общие отличия:

  3.1.	В области 81h-... командная строка терминируется нулевым байтом.
	(стандартно - байтом 0Dh). Сделано для переносимости программ из
	CP/M.

  3.2.	Изменена диагностика ошибок. Теперь все сообщения об ошибках
	начинаются со знака "?", а потом идет одно-двух словное пояснение.

  3.3.		Введено по идее тов. Бараза:
	В байты по адресу 8,9 и 10 записываются ключи, введенные соотв.
	после команды, первого и второго операндов. Ключи записываются
	как логическое "или" всех ключей в одной позиции. Битовые значения
	ключей следующие:
		"Q"	40h
		"L"	20h
		"B"	10h
		"A"	 8
		"V"	 4
		"P"	 2
		"W"	 1

  3.4.		Введено по идее тов. Галутина:
	Версия 2.nM отличается от 2.n тем, что при инициации монитора
	он записывает свой код в неиспользуемое при обычной работе
	пространство видео-ОЗУ. Когда какая-либо программа возвращает
	управление в систему, hook в системной области ОЗУ проверяет,
	испорчен ли COMMAND в памяти. Если он не испорчен, то ему
	передается управление. Иначе код монитора считывается из видео-
	ОЗУ и снова проверяется на сохранность (по контр. сумме).
	Если же и там код испорчен (его портит в видео-ОЗУ, например,
	редактор TOR), то тогда COMMAND считывается с диска. Большинство
	же программ, которые уничтожают COMMAND в ОЗУ, не трогают его
	в видео-ОЗУ (напр., SCED,S-BUG), поэтому не приходится каждый
	раз считывать монитор с диска!
	Замечание: hook сидит по адресу F980, занимая области VOICEA и
	VOICEB. При порче этой области работа системы далее невозможна!

Автор: Терехов С.А. (Новосибирск, ЛШИ ВЦ СО АН)

Со всеми замечаниями и предложениями обращайтесь:
тел. 32-42-56 (Новосибирск, ВЦ СО АН).

